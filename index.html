<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <script src="https://telegram.org/js/telegram-web-app.js?58"></script>

  <title>–§–æ—Ä–º–∞ —Ñ—É—à–∫–∏</title>
  <style>
    body {
      font-family: sans-serif;
      background-color: #f9f9f9;
      padding: 20px;
      max-width: 500px;
      margin: auto;
    }
    h1 {
      text-align: center;
      color: #1b4d8a;
    }
    label {
      display: block;
      margin-top: 15px;
      font-weight: bold;
    }
    input, textarea, select {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      border: 1px solid #ccc;
      border-radius: 5px;
      font-size: 16px;
    }
    button {
      margin-top: 20px;
      width: 100%;
      padding: 12px;
      background-color: #1b4d8a;
      color: white;
      border: none;
      border-radius: 5px;
      font-size: 16px;
      cursor: pointer;
    }
    button:hover {
      background-color: #153d70;
    }
  </style>
</head>
<body>
  <h1>–ù–æ–≤–∞ —Ñ—É—à–∫–∞</h1>
  
  <!-- –î—ñ–∞–≥–Ω–æ—Å—Ç–∏—á–Ω–∞ –ø–∞–Ω–µ–ª—å -->
  <div id="debug-panel" style="background: #f0f0f0; padding: 10px; margin: 10px 0; border-radius: 5px; font-size: 12px;">
    <div><strong>Version: 3</strong></div>
    <strong>üîß –î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:</strong>
    <div id="debug-info">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</div>
    <button type="button" onclick="showDebugInfo()" style="background: #666; margin-top: 5px; padding: 5px 10px; font-size: 12px;">–û–Ω–æ–≤–∏—Ç–∏ –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫—É</button>
  </div>
  
  <form id="fushka-form">
    <label for="description">üìù –û–ø–∏—Å —Ñ—É—à–∫–∏</label>
    <textarea id="description" name="description" required></textarea>

    <label for="company">üè¢ –ù–∞–∑–≤–∞ –∫–æ–º–ø–∞–Ω—ñ—ó</label>
    <input id="company" name="company" required />

    <label for="location">üìç –õ–æ–∫–∞—Ü—ñ—è</label>
    <input id="location" name="location" required />

    <label for="date">üìÜ –î–∞—Ç–∞</label>
    <input id="date" name="date" type="text" required />

    <label for="hours">‚è∞ –ü–æ—á–∞—Ç–æ–∫ / –∫—ñ–Ω–µ—Ü—å</label>
    <input id="hours" name="hours" required />

    <label for="rate">üí∞ –°—Ç–∞–≤–∫–∞ (Kƒç/–≥–æ–¥)</label>
    <input id="rate" name="rate" type="number" required />

    <label for="type">üß§ –¢–∏–ø —Ä–æ–±–æ—Ç–∏</label>
    <input id="type" name="type" required />

    <label for="people">üë§ –ö—ñ–ª—å–∫—ñ—Å—Ç—å –ª—é–¥–µ–π</label>
    <input id="people" name="people" type="number" required />

    <label for="note">üìù –î–æ–¥–∞—Ç–∫–æ–≤–æ</label>
    <textarea id="note" name="note"></textarea>

    <button id="submit-button" type="button">–ù–∞–¥—ñ—Å–ª–∞—Ç–∏</button>
  </form>

  <script>
    // –î–æ–¥–∞—î–º–æ –≥–ª–æ–±–∞–ª—å–Ω–∏–π –ª–æ–≥–≥–µ—Ä –¥–ª—è –∑—Ä—É—á–Ω–æ—Å—Ç—ñ
    function log(...args) {
      console.log('[FUSHKA LOG]', ...args);
    }

    // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏—á–Ω–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó
    function showDebugInfo() {
        log('–í–∏–∫–ª–∏–∫ showDebugInfo');
        const debugInfo = document.getElementById('debug-info');
        const telegram = window.Telegram || window.telegram;
        const webApp = telegram ? (telegram.WebApp || telegram.webApp) : null;
        log('showDebugInfo: telegram =', telegram);
        log('showDebugInfo: webApp =', webApp);
        
        const info = {
            'User Agent': navigator.userAgent,
            'Telegram –æ–±\'—î–∫—Ç': telegram ? '‚úÖ –ó–Ω–∞–π–¥–µ–Ω–æ' : '‚ùå –ù–µ –∑–Ω–∞–π–¥–µ–Ω–æ',
            'Telegram.WebApp': webApp ? '‚úÖ –ó–Ω–∞–π–¥–µ–Ω–æ' : '‚ùå –ù–µ –∑–Ω–∞–π–¥–µ–Ω–æ',
            'URL': window.location.href,
            '–ß–∞—Å –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è': new Date().toLocaleString('uk-UA'),
            'window.Telegram': window.Telegram ? '‚úÖ –Ñ' : '‚ùå –ù–µ–º–∞—î',
            'window.telegram': window.telegram ? '‚úÖ –Ñ' : '‚ùå –ù–µ–º–∞—î'
        };
        
        let debugText = '';
        for (let [key, value] of Object.entries(info)) {
            debugText += `<strong>${key}:</strong> ${value}<br>`;
        }
        debugInfo.innerHTML = debugText;
        log('showDebugInfo: –æ–Ω–æ–≤–ª–µ–Ω–æ –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏—á–Ω—É –ø–∞–Ω–µ–ª—å');
    }

    // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó Telegram WebApp
    function initTelegramWebApp() {
        log('–°–ø—Ä–æ–±–∞ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó Telegram WebApp...');
        log('window.Telegram:', window.Telegram);
        log('window.Telegram.WebApp:', window.Telegram ? window.Telegram.WebApp : '–Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ');
        
        // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —Ä—ñ–∑–Ω—ñ –≤–∞—Ä—ñ–∞–Ω—Ç–∏ –¥–æ—Å—Ç—É–ø—É –¥–æ Telegram WebApp
        const telegram = window.Telegram || window.telegram;
        const webApp = telegram ? (telegram.WebApp || telegram.webApp) : null;
        
        log('–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ - telegram:', telegram);
        log('–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ - webApp:', webApp);
        
        if (telegram && webApp) {
            try {
                log('–í–∏–∫–ª–∏–∫–∞—î–º–æ webApp.ready()');
                webApp.ready();
                log('–í–∏–∫–ª–∏–∫–∞—î–º–æ webApp.expand()');
                webApp.expand();
                log('Telegram WebApp —É—Å–ø—ñ—à–Ω–æ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ!');
                return true;
            } catch (error) {
                log('–ü–æ–º–∏–ª–∫–∞ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó Telegram WebApp:', error);
                return false;
            }
        } else {
            log('Telegram WebApp –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ!');
            return false;
        }
    }

    // –î–æ–¥–∞—î–º–æ –ª–æ–≥—É–≤–∞–Ω–Ω—è –¥–ª—è –≤—Å—ñ—Ö –ø–æ–ª—ñ–≤ —Ñ–æ—Ä–º–∏
    function addFormFieldLogging() {
      const form = document.getElementById('fushka-form');
      if (!form) {
        log('–§–æ—Ä–º–∞ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–∞ –¥–ª—è –ª–æ–≥—É–≤–∞–Ω–Ω—è –ø–æ–ª—ñ–≤!');
        return;
      }
      const fields = form.querySelectorAll('input, textarea, select');
      fields.forEach(field => {
        field.addEventListener('input', (e) => {
          log(`–ü–æ–ª–µ '${field.name}' –∑–º—ñ–Ω–∏–ª–æ—Å—å:`, e.target.value);
        });
        field.addEventListener('focus', (e) => {
          log(`–§–æ–∫—É—Å –Ω–∞ –ø–æ–ª—ñ '${field.name}'`);
        });
        field.addEventListener('blur', (e) => {
          log(`–í—Ç—Ä–∞—Ç–∞ —Ñ–æ–∫—É—Å—É –∑ –ø–æ–ª—è '${field.name}', –∑–Ω–∞—á–µ–Ω–Ω—è:`, e.target.value);
        });
      });
      log('–î–æ–¥–∞–Ω–æ –ª–æ–≥—É–≤–∞–Ω–Ω—è –¥–ª—è –≤—Å—ñ—Ö –ø–æ–ª—ñ–≤ —Ñ–æ—Ä–º–∏');
    }

    // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ DOM
    document.addEventListener("DOMContentLoaded", function() {
        log('DOM –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ, —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î–º–æ Telegram WebApp...');
        
        // –ü–æ–∫–∞–∑—É—î–º–æ –ø–æ—á–∞—Ç–∫–æ–≤—É –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫—É
        showDebugInfo();
        
        // –î–æ–¥–∞—î–º–æ –ª–æ–≥—É–≤–∞–Ω–Ω—è –¥–ª—è –ø–æ–ª—ñ–≤ —Ñ–æ—Ä–º–∏
        addFormFieldLogging();
        
        // –°–ø—Ä–æ–±–∞ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó
        if (!initTelegramWebApp()) {
            log('–ü–µ—Ä—à–∞ —Å–ø—Ä–æ–±–∞ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó –Ω–µ –≤–¥–∞–ª–∞—Å—è, —á–µ–∫–∞—î–º–æ 1 —Å–µ–∫.');
            // –Ø–∫—â–æ –Ω–µ –≤–¥–∞–ª–æ—Å—è —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –æ–¥—Ä–∞–∑—É, —Å–ø—Ä–æ–±—É—î–º–æ —á–µ—Ä–µ–∑ –Ω–µ–≤–µ–ª–∏–∫—É –∑–∞—Ç—Ä–∏–º–∫—É
            setTimeout(function() {
                log('–ü–æ–≤—Ç–æ—Ä–Ω–∞ —Å–ø—Ä–æ–±–∞ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó Telegram WebApp...');
                if (!initTelegramWebApp()) {
                    log('–î—Ä—É–≥–∞ —Å–ø—Ä–æ–±–∞ –Ω–µ –≤–¥–∞–ª–∞—Å—è, —á–µ–∫–∞—î–º–æ —â–µ 2 —Å–µ–∫.');
                    // –°–ø—Ä–æ–±–∞ —á–µ—Ä–µ–∑ –±—ñ–ª—å—à—É –∑–∞—Ç—Ä–∏–º–∫—É
                    setTimeout(function() {
                        log('–¢—Ä–µ—Ç—è —Å–ø—Ä–æ–±–∞ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó Telegram WebApp...');
                        if (!initTelegramWebApp()) {
                            log('Telegram WebApp –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ –ø—ñ—Å–ª—è —Ç—Ä—å–æ—Ö —Å–ø—Ä–æ–±!');
                            alert("Telegram WebApp –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ! –í—ñ–¥–∫—Ä–∏–π—Ç–µ —Ñ–æ—Ä–º—É —á–µ—Ä–µ–∑ Telegram.");
                        }
                        showDebugInfo();
                    }, 2000);
                }
                // –û–Ω–æ–≤–ª—é—î–º–æ –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫—É –ø—ñ—Å–ª—è —Å–ø—Ä–æ–±–∏
                showDebugInfo();
            }, 1000);
        } else {
            log('Telegram WebApp —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ –∑ –ø–µ—Ä—à–æ—ó —Å–ø—Ä–æ–±–∏!');
            // –û–Ω–æ–≤–ª—é—î–º–æ –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫—É —è–∫—â–æ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è —É—Å–ø—ñ—à–Ω–∞
            setTimeout(showDebugInfo, 500);
        }
    });

    // –ó–∞–±–æ—Ä–æ–Ω—è—î–º–æ –¥–µ—Ñ–æ–ª—Ç–Ω–∏–π submit —Ñ–æ—Ä–º–∏ —ñ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ —Ç—ñ–ª—å–∫–∏ –ø–æ –∫–ª—ñ–∫—É
    (function enableClickOnlySubmit() {
        const form = document.getElementById('fushka-form');
        const submitButton = document.getElementById('submit-button');

        if (!form || !submitButton) {
            log('–ù–µ –∑–Ω–∞–π–¥–µ–Ω–æ —Ñ–æ—Ä–º—É –∞–±–æ –∫–Ω–æ–ø–∫—É –¥–ª—è –≤—ñ–¥–ø—Ä–∞–≤–∫–∏');
            return;
        }

        // –ë–ª–æ–∫—É—î–º–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–π submit –∑ –∫–ª–∞–≤—ñ–∞—Ç—É—Ä–∏/—Ç–∞—á–∞
        form.addEventListener('submit', function(event) {
            event.preventDefault();
            return false;
        });

        // –•–µ–ª–ø–µ—Ä: –∑–±–∏—Ä–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –∑ —Ñ–æ—Ä–º–∏
        function collectFormData() {
            const formData = new FormData(form);
            const data = {};
            for (let [key, value] of formData.entries()) {
                data[key] = value;
            }
            data.timestamp = new Date().toISOString();
            data.userAgent = navigator.userAgent;
            return data;
        }

        // –í–∞–ª—ñ–¥–∞—Ü—ñ—è —á–µ—Ä–µ–∑ HTML5 API
        function validateForm() {
            if (form.checkValidity()) {
                return true;
            }
            // –ü—ñ–¥—Å–≤—ñ—á—É—î–º–æ –Ω–µ–≤–∞–ª—ñ–¥–Ω—ñ –ø–æ–ª—è –Ω–∞—Ç–∏–≤–Ω–æ
            form.reportValidity();
            return false;
        }

        // –û—Å–Ω–æ–≤–Ω–∏–π —Ö–µ–Ω–¥–ª–µ—Ä –∫–ª—ñ–∫—É
        submitButton.addEventListener('click', async function(event) {
            event.preventDefault();
            log('–ö–ª—ñ–∫ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏...');

            if (!validateForm()) {
                log('–í–∞–ª—ñ–¥–∞—Ü—ñ—è –Ω–µ –ø—Ä–æ–π–¥–µ–Ω–∞');
                return;
            }

            const data = collectFormData();
            log('–î–∞–Ω—ñ —Ñ–æ—Ä–º–∏:', data);

            const originalText = submitButton.textContent;
            submitButton.textContent = '–í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ...';
            submitButton.disabled = true;

            try {
                const telegram = window.Telegram || window.telegram;
                const webApp = telegram ? (telegram.WebApp || telegram.webApp) : null;

                if (telegram && webApp) {
                    log('–í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ –¥–∞–Ω—ñ —á–µ—Ä–µ–∑ Telegram WebApp:', data);
                    webApp.sendData(JSON.stringify(data));
                    log('–í—ñ–¥–ø—Ä–∞–≤–∫–∞ —ñ–Ω—ñ—Ü—ñ–π–æ–≤–∞–Ω–∞, –∑–∞–∫—Ä–∏–≤–∞—î–º–æ WebApp.');
                    webApp.close();
                } else {
                    log('Telegram WebApp –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π. –í—ñ–¥–ø—Ä–∞–≤–∫–∞ –∑–∞–±–æ—Ä–æ–Ω–µ–Ω–∞ –∑–∞ –≤–∏–º–æ–≥–æ—é –±–µ–∑ –ø—Ä—è–º–∏—Ö HTTP-–∑–∞–ø–∏—Ç—ñ–≤.');
                    alert('–í—ñ–¥–∫—Ä–∏–π—Ç–µ —Ñ–æ—Ä–º—É —á–µ—Ä–µ–∑ Telegram –¥–ª—è –≤—ñ–¥–ø—Ä–∞–≤–∫–∏. –ü—Ä—è–º—ñ HTTP-–∑–∞–ø–∏—Ç–∏ –≤–∏–º–∫–Ω–µ–Ω–æ.');
                }
            } catch (error) {
                log('–ó–∞–≥–∞–ª—å–Ω–∞ –ø–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –≤—ñ–¥–ø—Ä–∞–≤—Ü—ñ:', error);
                alert('‚ùå –ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–∏—Ö: ' + error.message);
            } finally {
                submitButton.textContent = originalText;
                submitButton.disabled = false;
            }
        });
    })();
  </script>
</body>
</html>